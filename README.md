# Shader Live Coding Application

リアルタイムシェーダーライブコーディングアプリケーション。VJパフォーマンスや創造的なビジュアル表現のために設計されています。

## 機能

- **リアルタイムシェーダー編集**: GLSL、WGSL、Slangに対応
- **音楽同期**: オーディオファイルを読み込んで、音楽に反応するビジュアルを作成
- **プリセット管理**: 作成したシェーダーを保存・管理
- **VJモード**: フルスクリーン表示とキーボードショートカット
- **エクスポート機能**: 静止画や動画として作品を保存

## インストール

### 必要な環境

- Node.js 18以降
- pnpm
- Rust（Tauriのビルドに必要）

### セットアップ

```bash
# 依存関係のインストール
pnpm install

# 開発サーバーの起動
pnpm tauri dev

# アプリケーションのビルド
pnpm tauri build
```

## 使い方

### 基本的な操作

1. **シェーダーの編集**
   - 左側のエディタにGLSLコードを入力
   - 自動的にプレビューが更新されます
   - シンタックスエラーはエディタ下部に表示されます

2. **プリセットの使用**
   - 「Select Preset」ドロップダウンから既存のプリセットを選択
   - カスタムプリセットを保存するには「Save as Preset」ボタンを使用

3. **音楽の同期**
   - 「Load Audio」ボタンからオーディオファイルを選択
   - 再生/一時停止ボタンで音楽をコントロール
   - シェーダー内で`iAudioData`や`iFrequency`などの変数を使用して音楽データにアクセス

### シェーダー変数

以下の組み込み変数が使用できます：

- `iResolution` - 画面の解像度（vec3）
- `iTime` - 経過時間（float）
- `iMouse` - マウスの座標（vec4）
- `iAudioData` - オーディオの波形データ（sampler2D）
- `iFrequency` - 周波数データ（sampler2D）
- `iBass`, `iMid`, `iTreble` - 低音、中音、高音の強度（float）

### プリセットシェーダー

#### Basic Template
基本的なシェーダーのテンプレート。カスタムシェーダーの出発点として使用できます。

```glsl
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;
    vec3 col = vec3(uv, 0.5 + 0.5 * sin(iTime));
    fragColor = vec4(col, 1.0);
}
```

#### Rainbow Wave
時間とともに変化する虹色のウェーブパターン。

#### Audio Visualizer
音楽に反応する円形のビジュアライザー。音楽を読み込んで使用してください。

#### Spectrum Bars
周波数スペクトラムを表示するバー表示。音楽分析に最適です。

#### Particle Flow
音楽に反応するパーティクルシステム。

### Sound Programming（シンセサイザー）

右側パネルの下部にある音楽生成ツール：

- **独立したシンセサイザー**（シェーダーには影響しません）
- **波形選択**: Sine、Square、Sawtooth、Triangleから選択
- **エンベロープ調整**: Attack、Decay、Sustain、Releaseで音の形を制御
- **音量調整**: -30dB〜0dBの範囲で調整
- **キーボード**: C4〜B4の音階をテスト
- **シーケンサー**: BPM調整可能な自動演奏機能

**使用例**:
1. 波形を「Square」に変更してレトロゲーム風の音に
2. Attackを長くしてふわっとした立ち上がりに
3. Releaseを長くして余韻のある音に
4. シーケンサーでリズムパターンを作成

**注意**: このツールで生成した音は、読み込んだオーディオファイルの音楽データのようにシェーダーには反映されません。VJパフォーマンス中のサウンドエフェクトとして使用することを想定しています。

### VJモード

VJパフォーマンス用の機能：

- **F11**: フルスクリーン切り替え
- **Space**: 再生/一時停止
- **1-9**: プリセットの切り替え
- **Esc**: フルスクリーン終了

#### ライブコーディング機能

VJモード中にリアルタイムでコードを編集できる機能：

- **Ctrl+E**: ライブコーディングエディタの表示/非表示
- **Ctrl+Enter**: コードの適用（エディタ内）
- **Esc**: エディタを閉じる（エディタ内）

この機能により、観客に対してコーディングプロセスを見せながら、リアルタイムでビジュアルを変更するパフォーマンスが可能になります。エディタは半透明の背景で表示され、美しいブラー効果により背後のビジュアルとの調和を保ちながらコードを編集できます。

**特徴**:
- 見やすいモノスペースフォント
- フォントサイズ調整機能（A-/A+ボタン）
- 洗練されたダークテーマ
- スムーズなアニメーション効果

### プロジェクトの保存と読み込み

- **Save Project**: 現在の作業状態（シェーダー、設定、音楽）を保存
- **Load Project**: 保存したプロジェクトを読み込み
- **Export Project**: プロジェクトを共有可能なファイルとしてエクスポート

### エクスポート機能

作品を以下の形式でエクスポートできます：

- **Screenshot (PNG)**: 現在のフレームを静止画として保存
- **Video (WebM)**: アニメーションを動画として録画
- **GIF**: ループアニメーションとして保存

## トラブルシューティング

### シェーダーがコンパイルされない
- GLSL ES 3.0の構文を使用しているか確認してください
- `mainImage`関数が正しく定義されているか確認してください
- エラーメッセージを確認して構文エラーを修正してください

### 音楽が読み込めない
- 対応フォーマット: MP3, WAV, OGG
- ブラウザのオーディオ許可を確認してください
- CORSエラーの場合は、ローカルファイルを使用してください

### パフォーマンスの問題
- 複雑なシェーダーは負荷が高くなります
- 解像度を下げることで改善される場合があります
- 不要なループや計算を最適化してください

## 開発者向け情報

### プロジェクト構造

```
shader-live-cording/
├── src/              # フロントエンドソースコード
│   ├── lib/          # コンポーネントとユーティリティ
│   ├── routes/       # SvelteKitルート
│   └── app.html      # HTMLテンプレート
├── src-tauri/        # Tauriバックエンド
│   ├── src/          # Rustソースコード
│   └── Cargo.toml    # Rust依存関係
├── static/           # 静的アセット
└── package.json      # Node.js依存関係
```

### 技術スタック

- **フロントエンド**: Svelte 5, TypeScript
- **デスクトップ**: Tauri 2.0
- **シェーダー**: WebGL 2.0
- **データベース**: SQLite（Tauri統合）
- **オーディオ**: Web Audio API

### 貢献

プルリクエストは歓迎します。大きな変更の場合は、まずissueを作成して変更内容を議論してください。

## ライセンス

[MITライセンス](LICENSE)