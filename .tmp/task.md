# シェーダーライブコーディングアプリケーション タスクリスト

## Phase 1: プロジェクトセットアップと基盤構築

### 1.1 依存関係のインストール
- [x] Svelte 5の基本的なコンポーネント構造の確認
- [x] DuckDB WASMのインストールと設定
- [x] コードエディタライブラリの選定とインストール（Monaco Editor推奨）
- [x] Web Audio API関連ライブラリの調査とインストール
- [x] WebGL/WebGPU関連ユーティリティの準備

### 1.2 プロジェクト構造の整備
- [x] srcディレクトリ構造の作成
- [x] 基本的なルーティング設定
- [ ] Svelteストアの初期設定
- [x] TypeScript型定義ファイルの準備

### 1.3 Tauri設定
- [ ] Tauri 2.0の初期設定確認
- [ ] 必要な権限の設定（ファイルシステム、音楽ファイルアクセス）
- [ ] ウィンドウ設定（サイズ、リサイズ、フルスクリーン対応）

## Phase 2: 基本UI実装

### 2.1 レイアウトコンポーネント
- [x] メインレイアウトコンポーネントの作成（3ペイン）
- [ ] ペイン間のリサイズ機能実装
- [x] ダークテーマのスタイル設定

### 2.2 エディタコンポーネント
- [x] Monaco Editorの統合
- [x] Monaco EditorのURI関連エラーの修正（toUri関数）
- [ ] GLSL/WGSL/Slangのシンタックスハイライト設定
- [x] 基本的なエディタ設定（フォント、テーマ等）
- [ ] タブ機能の実装

### 2.3 プレビューコンポーネント
- [x] WebGLキャンバスの初期化
- [x] 基本的なフレームループの実装
- [x] エラーハンドリング

### 2.4 コントロールパネル
- [x] 基本的なUIコントロール（再生/停止、リセット）
- [x] FPS表示
- [x] エラーメッセージ表示エリア

## Phase 3: シェーダーレンダリングエンジン

### 3.1 WebGLコンテキスト管理
- [x] WebGL2コンテキストの初期化
- [x] シェーダーコンパイル機能
- [x] エラーハンドリングとデバッグ情報

### 3.2 シェーダー管理システム
- [ ] GLSLパーサーの実装
- [ ] uniform変数の自動検出
- [x] デフォルトuniform変数の設定（time, resolution, mouse等）

### 3.3 レンダリングパイプライン
- [x] 基本的なクワッドレンダリング
- [ ] フレームバッファ管理
- [ ] マルチパスレンダリング対応

## Phase 4: 音楽機能実装

### 4.1 音楽ファイル読み込み
- [x] ファイル選択UI
- [x] 対応フォーマットの検証（MP3, WAV, OGG）
- [x] Web Audio APIでの音楽再生

### 4.2 音楽解析
- [x] FFTアナライザーの実装
- [x] 周波数帯域の分割
- [x] ビート検出アルゴリズム
- [x] BPM計算

### 4.3 シェーダーとの連携
- [x] 音楽データのuniform変数マッピング
- [x] リアルタイム更新機能
- [x] ビジュアライザーコンポーネント

## Phase 5: データベース統合

### 5.1 DuckDB設定
- [x] WASM版DuckDBの初期化
- [x] データベーススキーマの作成
- [x] 接続管理

### 5.2 プリセット機能
- [x] プリセット保存UI
- [x] プリセット読み込みUI
- [x] プリセット管理（編集、削除）

### 5.3 プロジェクト管理
- [ ] プロジェクト保存機能
- [ ] プロジェクト読み込み機能
- [ ] 自動保存機能

## Phase 6: 高度な機能

### 6.1 サウンドプログラミング
- [x] Web Audio APIノードエディタ
- [x] オシレーター、フィルターUI
- [ ] 音とビジュアルの相互作用

### 6.2 VJモード
- [ ] フルスクリーン切り替え
- [ ] パフォーマンスモードUI
- [ ] キーボードショートカット設定
- [ ] シーン管理とトランジション

### 6.3 エクスポート機能
- [x] 静止画エクスポート（PNG, JPEG）
- [x] 動画録画機能（WebM）
- [x] スタンドアロンHTMLエクスポート
- [x] 音楽同期ビデオエクスポート
- [x] エクスポートモーダルUI（ExportModal）
- [x] エクスポートボタンコンポーネント（ExportButton）
- [ ] GIFアニメーション出力（将来的な拡張）

### 6.4 GLSLFunctions/SoundProgramming機能デバッグ
- [x] GLSLFunctions.svelteコンポーネントの確認
- [x] SoundProgramming.svelteコンポーネントの確認
- [x] エディタへのコード挿入機能の検証
- [ ] コンポーネント間の連携問題の修正

## Phase 7: 最適化とポリッシュ

### 7.1 パフォーマンス最適化
- [ ] レンダリング最適化
- [ ] メモリ使用量の監視と最適化
- [ ] 音楽同期の遅延改善

### 7.2 UX改善
- [ ] ツールチップとヘルプ
- [ ] キーボードショートカットのカスタマイズ
- [ ] ユーザー設定の保存

### 7.3 テストとドキュメント
- [ ] ユニットテストの作成
- [ ] 統合テスト
- [ ] ユーザーマニュアルの作成

## 実装優先順位

1. **最優先**: Phase 1-3（基本的な動作確認まで）
2. **高優先**: Phase 4（音楽機能）
3. **中優先**: Phase 5（データベース）
4. **低優先**: Phase 6-7（高度な機能と最適化）

## 注意事項

- 各フェーズは相互に依存関係があるため、順序を守って実装する
- 各タスクの完了時にはテストを実施
- パフォーマンスを常に意識し、60FPSを維持
- エラーハンドリングを確実に実装